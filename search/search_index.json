{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>fcache is a FlatBuffers cache over WebSockets.</p> <p>There is support for key-values, with containers such as arrays and lists, coming soon.</p> <p>FlatBuffers offer zero-copy deserialising: when the server receives data, it can deserialise without an intermediate step which requires allocating memory (as with ProtoBuf), and is considerably more compact than JSON.</p>"},{"location":"kv/","title":"Key Values","text":""},{"location":"kv/#listarrayvector-values","title":"List/Array/Vector Values","text":"<p>A value which is not scalar is serialised as a <code>TypedVector</code>. This means that all elements of the vector must be the same type. </p> <p>Using Python as an example:</p> Lists<pre><code>data =\n{\n  'animals':['cat', 'dog', 'horse'],\n  'scores':[50,55,5]\n  'anything':['xyz', 15, False]\n}\n</code></pre> <p>Storing <code>animals</code> and <code>scores</code> will succeed but <code>anything</code> will fail.</p>"},{"location":"kv/#caching-json","title":"Caching JSON","text":"<p>There is no native JSON support, so JSON must be stored as either as a string or converting to a compatible dictionary/map structure.</p> <p>Note</p> <p>The Python API functions <code>set</code>, <code>add</code> and <code>clear_set</code> accept <code>dict</code> for key values.</p>"},{"location":"api_py/intro/","title":"Overview","text":"<p>The <code>fc.Client</code> manages the connection, with a separate class for KV specific commands (and in the future, arrays, lists, etc).</p> <p>The command classes require a <code>Client</code> object.</p>"},{"location":"api_py/intro/#connect","title":"Connect","text":"<pre><code>import fc\n\nasync def connect() -&gt; fc.Client:\n  try:\n    client = await fc.fcache(uri='ws://127.0.0.1:1987')\n    # or: client = await fc.fcache(ip='127.0.0.1', port=1987)\n  except:\n    print ('Failed to connect')\n    client = None\n  return client\n</code></pre>"},{"location":"api_py/intro/#kv","title":"KV","text":"<p>List Values</p> <ul> <li>A list cannot be empty</li> <li>If a key's value is a <code>list</code>, all elements must be the same type:</li> </ul> <pre><code>await kv.set({'a':[]})          # ValueError: empty, can't determine element type\nawait kv.set({'a':[1, 2, 3]})   # Ok\nawait kv.set({'b':[1, 2.5, 3]}) # ValueError: int, float, int    \n</code></pre> <pre><code>from fc.kv import KV\n\nasync def kv():\n  if (client := await connect()) is None:\n    return\n\n  # create API object for KV commands\n  kv = KV(client)\n\n  await kv.set({'player':'Monster',\n                'level':25,\n                'active':True,\n                'perks':['Armour','Kilt']})\n\n  # get single key, returns the value (or None if key not found)\n  age = await kv.get(key='level')\n  print(f'Age: {age}')\n\n  # get multiple keys, returns dict\n  rsp = await kv.get(keys=['player', 'active'])\n  print(f\"Player: {rsp['player']}, Active: {rsp['active']}\")\n\n  # get list\n  print(await kv.get(key='perks'))\n</code></pre> <pre><code>Age: 25\nPlayer: Monster, Active: True\n['Armour', 'Kilt']\n</code></pre>"},{"location":"api_py/intro/#exceptions","title":"Exceptions","text":"<ul> <li><code>ResponseError</code> : raised when a failed response is received</li> <li><code>ValueError</code> : raised by the API before a request is sent</li> <li><code>OSError</code> : if opening the connection fails</li> </ul>"},{"location":"api_py/intro/#types","title":"Types","text":"Python FlatBuffers/FlexBuffers Server int int <code>int64</code> float float <code>float</code> (4 bytes) str string <code>std::vector&lt;char&gt;</code> bool bool <code>bool</code> list[int] TypedVector: VECTOR_INT <code>std::vector&lt;int64&gt;</code> list[float] TypedVector: VECTOR_FLOAT <code>std::vector&lt;float&gt;</code> list[str] TypedVector: VECTOR_KEY <code>std::vector&lt;std::string&gt;</code> list[bool] TypedVector: VECTOR_BOOL <code>std::vector&lt;bool&gt;</code> <p>Note</p> <p>A <code>TypedVector</code> is a vector (contigious array) where each element is the same type.</p>"},{"location":"api_py/kv/add/","title":"add","text":"<pre><code>async def add(kv: dict) -&gt; None\n</code></pre> <p>Sets new key(s) but unlike set, if a key already exists, the value is not replaced.</p> <p>Note</p> <p>If value is a <code>list</code>, all items must be the same type.</p>"},{"location":"api_py/kv/add/#examples","title":"Examples","text":"<pre><code>await kv.set({'user':'user1', 'age':25, 'active':True})\n# calling add() will not update age\nawait kv.add({'age':25})\n</code></pre>"},{"location":"api_py/kv/clear/","title":"clear","text":"<pre><code>async def clear() -&gt; None\n</code></pre> <p>Deletes all keys.</p> <p>You can also use <code>clear_set()</code> to delete all keys then set new keys in a single call.</p>"},{"location":"api_py/kv/clear/#examples","title":"Examples","text":"<pre><code>await kv.set({'user':'user1', 'age':25, 'active':True, 'city':'London'})\nawait kv.clear()\n</code></pre>"},{"location":"api_py/kv/clear_set/","title":"clear_set","text":"<pre><code>async def clear_set(kv:dict) -&gt; None:\n</code></pre> <p>Deletes all keys then sets new keys in a single command.</p> <p>Note</p> <p>If value is a <code>list</code>, all items must be the same type.</p>"},{"location":"api_py/kv/clear_set/#examples","title":"Examples","text":"<pre><code>await kv.set({'k1':10, 'k2':20})\nawait kv.clear_set({'k3':30, 'k4':40})\n# only k3 and k4 exist\n</code></pre>"},{"location":"api_py/kv/contains/","title":"contains","text":"<pre><code>async def contains(keys: list) -&gt; set\n</code></pre> <p>Given a list of keys, return those which exist.</p>"},{"location":"api_py/kv/contains/#returns","title":"Returns","text":"<p>A <code>set</code> of keys that exist.</p>"},{"location":"api_py/kv/contains/#examples","title":"Examples","text":"<pre><code>await kv.set({'user':'user1', 'age':25, 'active':True, 'city':'London'})\nexist = await kv.count()\n# exist contains 'age' and 'user'\n</code></pre>"},{"location":"api_py/kv/count/","title":"count","text":"<pre><code>async def count() -&gt; int\n</code></pre> <p>Gets the number of keys.</p>"},{"location":"api_py/kv/count/#returns","title":"Returns","text":"<p>The number of keys that exist.</p>"},{"location":"api_py/kv/count/#examples","title":"Examples","text":"<pre><code>await kv.set({'user':'user1', 'age':25, 'active':True, 'city':'London'})\ncount = await kv.count() # 4\n</code></pre>"},{"location":"api_py/kv/get/","title":"get","text":"<pre><code>async def get(key=None, keys=[]) -&gt; dict | Any\n</code></pre> <p>Gets a single key or multiple keys.</p>"},{"location":"api_py/kv/get/#returns","title":"Returns","text":"<p>Called with:</p> <ul> <li><code>key</code>: if key exists the value is returned, otherwise <code>None</code></li> <li><code>keys</code>: all key values in a <code>dict</code></li> </ul>"},{"location":"api_py/kv/get/#examples","title":"Examples","text":"<pre><code>await kv.set({'user':'user1', 'age':25, 'active':True})\n\n# get single key, returns the value\nage = await kv.get(key='age')\nprint(f'Age: {age}')\n\n# get multiple keys, returns dict\nrsp = await kv.get(keys=['user', 'active'])\nprint(f\"User: {rsp['user']}, Active: {rsp['active']}\")\n</code></pre> <pre><code>Age: 25\nUser: user1, Active: True\n</code></pre>"},{"location":"api_py/kv/remove/","title":"remove","text":"<pre><code>async def remove(key='', keys=[]) -&gt; None\n</code></pre> <p>Deletes one or multiple keys.</p> <ul> <li><code>key</code> : individual key to delete</li> <li><code>keys</code> : list of keys to delete</li> </ul> <p>If a key does not exist it is not considered an error.</p>"},{"location":"api_py/kv/remove/#examples","title":"Examples","text":"<pre><code>await kv.set({'user':'user1', 'age':25, 'active':True, 'city':'London'})\nawait kv.remove(key='age')\nawait kv.remove(keys=['user','city'])\n# only 'active' remains\n</code></pre>"},{"location":"api_py/kv/set/","title":"set","text":"<pre><code>async def set(kv: dict) -&gt; None\n</code></pre> <p>Sets new key(s). If a key already exists, the value is replaced.</p> <p>Note</p> <p>If value is a <code>list</code>, all items must be the same type.</p>"},{"location":"api_py/kv/set/#examples","title":"Examples","text":"<pre><code>await kv.set({'user':'user1', 'age':25, 'active':True})\n</code></pre>"}]}